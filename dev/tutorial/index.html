<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tutorial · ConceptualClimateModels.jl</title><meta name="title" content="Tutorial · ConceptualClimateModels.jl"/><meta property="og:title" content="Tutorial · ConceptualClimateModels.jl"/><meta property="twitter:title" content="Tutorial · ConceptualClimateModels.jl"/><meta name="description" content="Documentation for ConceptualClimateModels.jl."/><meta property="og:description" content="Documentation for ConceptualClimateModels.jl."/><meta property="twitter:description" content="Documentation for ConceptualClimateModels.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ConceptualClimateModels.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li class="is-active"><a class="tocitem" href>Tutorial</a><ul class="internal"><li><a class="tocitem" href="#Terminology"><span>Terminology</span></a></li><li><a class="tocitem" href="#Introductory-example"><span>Introductory example</span></a></li><li><a class="tocitem" href="#Processes"><span>Processes</span></a></li><li><a class="tocitem" href="#Default-processes"><span>Default processes</span></a></li><li><a class="tocitem" href="#Adding-your-own-processes"><span>Adding your own processes</span></a></li><li><a class="tocitem" href="#A-note-on-symbolic-variable-instances"><span>A note on symbolic variable instances</span></a></li><li><a class="tocitem" href="#Default-values,-limits,-etc."><span>Default values, limits, etc.</span></a></li><li><a class="tocitem" href="#Automatically-named-parameters"><span>Automatically named parameters</span></a></li><li><a class="tocitem" href="#Integration-with-DynamicalSystems.jl"><span>Integration with DynamicalSystems.jl</span></a></li><li><a class="tocitem" href="#API-Reference"><span>API Reference</span></a></li><li><a class="tocitem" href="#generic_processes"><span>Generic processes</span></a></li></ul></li><li><span class="tocitem">Submodules</span><ul><li><a class="tocitem" href="../submodules/globalmeanebm/">Global mean EBM</a></li><li><a class="tocitem" href="../submodules/ctmlm/">Cloud Topped Mixed Layer Model</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/globalmeanebm/">Global mean EBM</a></li><li><a class="tocitem" href="../examples/ctmlm/">Cloud Topped Mixed Layer Model</a></li></ul></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Tutorial</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Tutorial</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaDynamics/ConceptualClimateModels.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaDynamics/ConceptualClimateModels.jl/blob/main/docs/src/tutorial.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="tutorial"><a class="docs-heading-anchor" href="#tutorial">Tutorial</a><a id="tutorial-1"></a><a class="docs-heading-anchor-permalink" href="#tutorial" title="Permalink"></a></h1><h2 id="Terminology"><a class="docs-heading-anchor" href="#Terminology">Terminology</a><a id="Terminology-1"></a><a class="docs-heading-anchor-permalink" href="#Terminology" title="Permalink"></a></h2><p>ConceptualClimateModels.jl follows a process-based modelling approach to make differential equation systems from <em>processes</em>. A <em>process</em> is simply a particular <em>equation</em> defining the dynamics of a climate variable, while also explicitly defining <em>which</em> variable the equation defines. A vector of processes is composed by the user, and given to the main function <a href="#ConceptualClimateModels.processes_to_coupledodes"><code>processes_to_coupledodes</code></a> which bundles them into a system of equations that creates a dynamical system. The dynamical system can then be further analyzed in terms of stability properties, multistability, tipping, periodic (or not) behavior, chaos, and many more aspects, via the DynamicalSystems.jl library (see the examples).</p><p>Note the distinction: a <em>process</em> is <em>not</em> the climate variable (such as &quot;clouds&quot; or  &quot;insolation&quot;); rather it is the <em>exact equation</em> that defines the behavior of the climate variable, and could itself utilize many other already existing climate variables, or introduce new ones. In terminology of climate science a <em>process</em> is a generalization of the term &quot;parameterization&quot;. Many different processes may <em>describe</em> the behavior of a particular variable and typically one wants to analyze what the model does when using one versus the other process.</p><div class="admonition is-info" id="Familiarity-with-DynamicalSystems.jl-and-ModelingToolkit.jl-43280c9d9f92bab2"><header class="admonition-header">Familiarity with DynamicalSystems.jl and ModelingToolkit.jl<a class="admonition-anchor" href="#Familiarity-with-DynamicalSystems.jl-and-ModelingToolkit.jl-43280c9d9f92bab2" title="Permalink"></a></header><div class="admonition-body"><p>ConceptualClimateModels.jl uses <a href="https://docs.sciml.ai/ModelingToolkit/stable/">ModelingToolkit.jl</a> for building the equations representing the climate model via <strong>symbolic expressions</strong>. It then uses <a href="https://juliadynamics.github.io/DynamicalSystemsDocs.jl/dynamicalsystems/dev/">DynamicalSystems.jl</a> to further analyze the models. Familiarity with either package is good to have (but not mandatory), and will allow you to faster and better understand the concepts discussed here.</p></div></div><h2 id="Introductory-example"><a class="docs-heading-anchor" href="#Introductory-example">Introductory example</a><a id="Introductory-example-1"></a><a class="docs-heading-anchor-permalink" href="#Introductory-example" title="Permalink"></a></h2><p>Let&#39;s say that we want to create the most basic energy balance model,</p><p class="math-container">\[c_T \frac{dT}{dt} = ASR - OLR + f\]</p><p>where <span>$ASR$</span> is the absorbed solar radiation given by</p><p class="math-container">\[ASR = S (1-\alpha)\]</p><p>with <span>$\alpha$</span> the planetary albedo, <span>$OLR$</span> is the outgoing longwave radiation given by the linearized expression</p><p class="math-container">\[OLR = A + BT\]</p><p>and <span>$f$</span> some radiative forcing at the top of the atmosphere, that is based on CO2 concentrations and given by</p><p class="math-container">\[f = 3.7\log_2\left(\frac{CO_2}{400}\right)\]</p><p>with CO2 concentrations in ppm.</p><p>To create this model with ConceptualClimateModels.jl while providing the least information possible we can do:</p><pre><code class="language-julia hljs">using ConceptualClimateModels
using ConceptualClimateModels.GlobalMeanEBM # submodule for global mean models

processes = [
    BasicRadiationBalance(),
    LinearOLR(),
    ParameterProcess(α),
    CO2Forcing(), # for default CO2 valu this is zero forcing
]

ds = processes_to_coupledodes(processes, GlobalMeanEBM)
println(dynamical_system_summary(ds))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">┌ Warning: Variable CO2(t) was introduced in process of variable f(t).
│ However, a process for CO2(t) was not provided,
│ and there is no default process for it either.
│ Since it has a default value, we make it a parameter by adding a process:
│ `ParameterProcess(CO2)`.
└ @ ProcessBasedModelling ~/.julia/packages/ProcessBasedModelling/dbWJG/src/make.jl:122
┌ Warning: Variable S(t) was introduced in process of variable ASR(t).
│ However, a process for S(t) was not provided,
│ and there is no default process for it either.
│ Since it has a default value, we make it a parameter by adding a process:
│ `ParameterProcess(S)`.
└ @ ProcessBasedModelling ~/.julia/packages/ProcessBasedModelling/dbWJG/src/make.jl:122
┌ Warning: Initialization system is overdetermined. 4 equations for 0 unknowns. Initialization will default to using least squares. `SCCNonlinearProblem` can only be used for initialization of fully determined systems and hence will not be used here. To suppress this warning pass warn_initialize_determined = false. To make this warning into an error, pass fully_determined = true
└ @ ModelingToolkit ~/.julia/packages/ModelingToolkit/EpUEk/src/systems/diffeqs/abstractodesystem.jl:1522
1-dimensional CoupledODEs
 deterministic: true
 discrete time: false
 in-place:      false

with equations:
 Differential(t)(T(t)) ~ (-0.0029390154298310064(ASR(t) + f(t) - OLR(t))) / (-τ_T)
 OLR(t) ~ -277.0 + 1.8T(t)
 S(t) ~ S_0
 α(t) ~ α_0
 CO2(t) ~ CO2_0
 ASR(t) ~ 340.25S(t)*(1 - α(t))
 f(t) ~ 3.7log2((1//400)*CO2(t))

and parameter values:
  :α_0 =&gt; 0.3
  :CO2_0 =&gt; 400.0
  :S_0 =&gt; 1.0
  :τ_T =&gt; 1.46951e6</code></pre><p>The output is a dynamical system from <a href="https://juliadynamics.github.io/DynamicalSystemsDocs.jl/dynamicalsystems/stable/">DynamicalSystems.jl</a> that is generated via symbolic expressions based on <a href="https://docs.sciml.ai/ModelingToolkit/stable/">ModelingToolkit.jl</a>, utilizing the process-based approach of <a href="https://juliadynamics.github.io/ProcessBasedModelling.jl/stable/">ProcessBasedModelling.jl</a>.</p><p>As the dynamical system is made by symbolic expressions, these can be obtained back at any time:</p><pre><code class="language-julia hljs">using DynamicalSystems
# access the MTK model that stores the symbolic bindings
mtk = referrenced_sciml_model(ds)
# show the equations of the dynamic state variables of the dynamical system
equations(mtk)</code></pre><p class="math-container">\[ \begin{align}
\frac{\mathrm{d} T\left( t \right)}{\mathrm{d}t} &amp;= \frac{ - 0.002939 \left( \mathtt{ASR}\left( t \right) + f\left( t \right) - \mathtt{OLR}\left( t \right) \right)}{ - \mathtt{\tau\_T}}
\end{align}
 \]</p><pre><code class="language-julia hljs"># show state functions that are observable,
# i.e., they do not have a time derivative, they are not dynamic state variables
observed(mtk)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{OLR}\left( t \right) &amp;= -277 + 1.8 T\left( t \right) \\
S\left( t \right) &amp;= \mathtt{S\_0} \\
\alpha\left( t \right) &amp;= \mathtt{\alpha\_0} \\
\mathtt{CO2}\left( t \right) &amp;= \mathtt{CO2\_0} \\
\mathtt{ASR}\left( t \right) &amp;= 340.25 S\left( t \right) \left( 1 - \alpha\left( t \right) \right) \\
f\left( t \right) &amp;= 3.7 \log_{2}\left( \frac{1}{400} \mathtt{CO2}\left( t \right) \right)
\end{align}
 \]</p><pre><code class="language-julia hljs"># show parameters
parameters(mtk)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4-element Vector{Any}:
 τ_T
 α_0
 CO2_0
 S_0</code></pre><p>The symbolic variables and parameters can also be used to query or alter the dynamical system. In the equations above we say that the symbolic variable <code>CO2</code> was equated to the parameter <code>CO2_0</code>. There are multiple ways to obtain a symbolic index provided we know its name. First, we can re-create the symbolic parameter:</p><pre><code class="language-julia hljs">index = only(@parameters CO2_0)</code></pre><p class="math-container">\[ \begin{equation}
\mathtt{CO2\_0}
\end{equation}
 \]</p><p>Second, we can use the retrieved MTK model and access its <code>CO2_0</code> field, which will return the symbolic variable:</p><pre><code class="language-julia hljs">index = mtk.CO2_0</code></pre><p class="math-container">\[ \begin{equation}
\mathtt{CO2\_0}
\end{equation}
 \]</p><p>Third, we can use a <code>Symbol</code> corresponding to the variable name. This is typically the simplest way.</p><pre><code class="language-julia hljs">index = :CO2_0</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">:CO2_0</code></pre><p>we can query the value of this named parameter in the system,</p><pre><code class="language-julia hljs">current_parameter(ds, index)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">400.0</code></pre><p>or alter it:</p><pre><code class="language-julia hljs"># access symbolic parameter CO2_0 from the tracked symbolic list of the model
set_parameter!(ds, index, 800)</code></pre><p>Similarly, we can obtain or alter values corresponding to the dynamic variables, or observed functions of the state of the system, using their symbolic indices. For example we can obtain the value corresponding to symbolic variable <span>$T$</span> at the current state of the dynamical system with:</p><pre><code class="language-julia hljs">observe_state(ds, T) # binding `T` already exists in scope</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">290.0</code></pre><p>We didn&#39;t have to create <code>T</code> because when we did <code>using ConceptualClimateModels.GlobalMeanEBM</code>, <code>T</code> was brought into scope. Similarly, we can obtain the <span>$OLR$</span> (outgoing longwave radiation), using the <code>Symbol</code> representation of the symbolic variable:</p><pre><code class="language-julia hljs">observe_state(ds, :OLR)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">245.0</code></pre><p>The advantage of using the symbolic variable <code>OLR</code> itself instead of its <code>Symbol</code> representation, is that symbolic variables can do arbitrary symbolic computations. For example let&#39;s say that when we created the equations of the system we didn&#39;t have defined a variable representing the expression <span>$T^2/OLR$</span>. That&#39;s not a problem, we can query the expression nevertheless:</p><pre><code class="language-julia hljs">observe_state(ds, T^2/OLR) # symbolic expression</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">343.265306122449</code></pre><p>Let&#39;s unpack the steps that led to this level of automation.</p><h2 id="Processes"><a class="docs-heading-anchor" href="#Processes">Processes</a><a id="Processes-1"></a><a class="docs-heading-anchor-permalink" href="#Processes" title="Permalink"></a></h2><p>A process is conceptually an <em>equation the defines a climate variable or observable</em>. All processes that define the system are then composed into a set of differential equations via <a href="#ConceptualClimateModels.processes_to_coupledodes"><code>processes_to_coupledodes</code></a> (or <a href="#ProcessBasedModelling.processes_to_mtkmodel"><code>processes_to_mtkmodel</code></a>) that represent the climate model.</p><p>For example, the process</p><pre><code class="language-julia hljs">T_process = BasicRadiationBalance()</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ConceptualClimateModels.GlobalMeanEBM.BasicRadiationBalance(5.0e8, f(t), T(t), ASR(t), OLR(t))</code></pre><p>is the process defining the variable <span>$T$</span>, representing temperature. We can learn this by either reading the documentation string of <a href="@ref"><code>BasicRadiationBalance</code></a>, or querying it directly:</p><pre><code class="language-julia hljs">using ProcessBasedModelling: lhs, rhs
# This is the equation created by the process
lhs(T_process) ~ rhs(T_process)</code></pre><p class="math-container">\[ \begin{equation}
\frac{\mathrm{d} T\left( t \right)}{\mathrm{d}t} \mathtt{\tau\_T} = 0.002939 \left( \mathtt{ASR}\left( t \right) + f\left( t \right) - \mathtt{OLR}\left( t \right) \right)
\end{equation}
 \]</p><p>Notice that this process does not further define e.g. outgoing longwave radiation <code>OLR(t)</code>. That is why in the original example we also provided <a href="@ref"><code>LinearOLR</code></a>, which defines it:</p><pre><code class="language-julia hljs">OLR_process = LinearOLR()
lhs(OLR_process) ~ rhs(OLR_process)</code></pre><p class="math-container">\[ \begin{equation}
\mathtt{OLR}\left( t \right) = -277 + 1.8 T\left( t \right)
\end{equation}
 \]</p><p>Each physical &quot;observable&quot; or variable that can be configured in the system has its own process. This allows very easily exchanging the way processes are represented by equations without having to alter many equations. For example, if instead of <code>LinearOLR</code> we have provided</p><pre><code class="language-julia hljs">OLR_process = EmissivityStefanBoltzmanOLR()
lhs(OLR_process) ~ rhs(OLR_process)</code></pre><p class="math-container">\[ \begin{equation}
\mathtt{OLR}\left( t \right) = 5.6704 \cdot 10^{-8} \left( T\left( t \right) \right)^{4} \varepsilon\left( t \right)
\end{equation}
 \]</p><p>then we would have used a Stefan-Boltzmann grey-atmosphere representation for the outgoing longwave radiation. Notice how this introduced an additional variable <span>$\varepsilon$</span>.</p><h2 id="Default-processes"><a class="docs-heading-anchor" href="#Default-processes">Default processes</a><a id="Default-processes-1"></a><a class="docs-heading-anchor-permalink" href="#Default-processes" title="Permalink"></a></h2><p>Hold on a minute though, because in the original processes we provided,</p><pre><code class="language-julia hljs">processes = [
    BasicRadiationBalance(),
    LinearOLR(),
    ParameterProcess(α),
    CO2Forcing(),
]</code></pre><p>there was no process that defined for example the absorbed solar radiation <span>$ASR$</span>!</p><p>Well, ConceptualClimateModels.jl allows the concept of <strong>default processes</strong>. The package exports some <strong>submodules</strong>, and each submodule targets a particular application of conceptual climate models. In this Tutorial we are using the <a href="../submodules/globalmeanebm/#GlobalMeanEBM"><code>GlobalMeanEBM</code></a> submodule, which provides functionality to model global mean energy balance models.</p><p>Each submodule defines and exports its own <strong>list of predefined symbolic variables</strong>. When we wrote</p><pre><code class="language-julia hljs">using ConceptualClimateModels.GlobalMeanEBM</code></pre><p>we brought into scope all the variables that this (sub)module defines and exports, such as <code>T, α, OLR</code>.</p><p>Each (sub)module and provides a list of <strong>predefined processes for its predefined symbolic variables</strong>. These predefined default processes are loaded automatically when we provide the (sub)module as a second argument to <code>processes_to_coupledodes</code>, which we did above. In this (sub)module, the default process for the <span>$ASR$</span> is <span>$ASR = S(1-\alpha)$</span> with <span>$S$</span> the solar constant.</p><p>The function <a href="#ConceptualClimateModels.processes_to_coupledodes"><code>processes_to_coupledodes</code></a> goes through all processes the user provided and identifies variables that themselves do not have a process. It then checks the list of default processes and attempts to assign one to these variables. If there are no default processes for some variables, it makes the variables themselves parameters with the same name but with a subscript 0 if the variables have a default value.</p><p>For example, let&#39;s assume that we completely remove default processes and we don&#39;t specify a process for the albedo <span>$α$</span>:</p><pre><code class="language-julia hljs">processes = [
    BasicRadiationBalance(),
    LinearOLR(),
    CO2Forcing(), # for default CO2 value this is zero forcing
    ASR ~ S*(1-α), # add the processes for ASR, but not for S or α
]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4-element Vector{Any}:
 ConceptualClimateModels.GlobalMeanEBM.BasicRadiationBalance(5.0e8, f(t), T(t), ASR(t), OLR(t))
 OLR(t) ~ -277.0 + 1.8T(t)
 ConceptualClimateModels.GlobalMeanEBM.CO2Forcing(f(t), CO2(t), 3.7)
 ASR(t) ~ S(t)*(1 - α(t))</code></pre><p>which we&#39;ll give to <code>processes_to_mtkmodel</code>. Notice how there is no second argument given, which would normally be the (sub)module to obtain default processes from.</p><p><em>side note: we use `process</em>to<em>mtkmodel<code>here, as we don&#39;t care yet for making a</code>DynamicalSystem`; just the symbolic model representation</em></p><pre><code class="language-julia hljs">mtk = processes_to_mtkmodel(processes)
# we access the equations directly from the model
equations(mtk)</code></pre><p class="math-container">\[ \begin{align}
\frac{\mathrm{d} T\left( t \right)}{\mathrm{d}t} \mathtt{\tau\_T} &amp;= 0.002939 \left( \mathtt{ASR}\left( t \right) + f\left( t \right) - \mathtt{OLR}\left( t \right) \right) \\
\mathtt{OLR}\left( t \right) &amp;= -277 + 1.8 T\left( t \right) \\
f\left( t \right) &amp;= 3.7 \log_{2}\left( \frac{1}{400} \mathtt{CO2}\left( t \right) \right) \\
\mathtt{ASR}\left( t \right) &amp;= S\left( t \right) \left( 1 - \alpha\left( t \right) \right) \\
\mathtt{CO2}\left( t \right) &amp;= \mathtt{CO2\_0} \\
\alpha\left( t \right) &amp;= \mathtt{\alpha\_0} \\
S\left( t \right) &amp;= \mathtt{S\_0}
\end{align}
 \]</p><p>You will notice the equation <span>$α = α_0$</span> where <span>$\alpha_0$</span> is now a <em>parameter</em> of the system (i.e., it can be altered after creating the system). The value of <span>$\alpha_0$</span> is the default value of <span>$\alpha$</span>:</p><pre><code class="language-julia hljs">default_value(α)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.3</code></pre><pre><code class="language-julia hljs"># current value of the _parameter_ α_0 (not the variable!)
default_value(mtk.α_0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.3</code></pre><p>When this automation occurs a warning is thrown:</p><pre><code class="nohighlight hljs">┌ Warning: Variable α(t) was introduced in process of variable ASR(t).
│ However, a process for α(t) was not provided,
│ and there is no default process for it either.
│ Since it has a default value, we make it a parameter by adding a process:
└ `ParameterProcess(α)`.</code></pre><p><a href="#ProcessBasedModelling.ParameterProcess"><code>ParameterProcess</code></a> is the most trivial process: it simply means that the corresponding variable does not have any actual process describing it and rather it is a system parameter.</p><p>This automation does not occur if there is no default value. For example, the <span>$ASR$</span> variable does not have a default value. If we have not assigned a process for <span>$ASR$</span>, the system construction would error instead:</p><pre><code class="language-julia hljs">processes = [
    BasicRadiationBalance(),
    LinearOLR(),
    CO2Forcing(),
]

mtk = processes_to_mtkmodel(processes)</code></pre><pre><code class="nohighlight hljs">ERROR: ArgumentError: Variable ASR(t) was introduced in process of
variable T(t). However, a process for ASR(t) was not provided,
there is no default process for ASR(t), and ASR(t) doesn&#39;t have a default value.
Please provide a process for variable ASR(t).</code></pre><p>These warnings and errors are always &quot;perfectly&quot; informative. They tell us exactly which variable does not have a process, and exactly which other process introduced the process-less variable first. This drastically improves the modelling experience, especially when large and complex models are being created.</p><h2 id="Adding-your-own-processes"><a class="docs-heading-anchor" href="#Adding-your-own-processes">Adding your own processes</a><a id="Adding-your-own-processes-1"></a><a class="docs-heading-anchor-permalink" href="#Adding-your-own-processes" title="Permalink"></a></h2><p>Each of the submodules of ConceptualClimateModels.jl provides an increasing list of predefined processes that you can use out of the box to compose climate models. The predefined processes all come from existing literature and cite their source via BiBTeX.</p><p>It is also very easy to make new processes on your own. The simplest way to make a process is to just provide an equation for it with the l.h.s. of the equation being the variable the process defines.</p><p>For example:</p><pre><code class="language-julia hljs">@variables x(t) = 0.5 # all variables must be functions of (t)
x_process = x ~ 0.5*T^2 # x is just a function of temperature</code></pre><p class="math-container">\[ \begin{equation}
x\left( t \right) = 0.5 \left( T\left( t \right) \right)^{2}
\end{equation}
 \]</p><p>A more re-usable approach however is to create a function that generates a process or create a new process type as we describe in <a href="#new_processes">making new processes</a>.</p><h2 id="A-note-on-symbolic-variable-instances"><a class="docs-heading-anchor" href="#A-note-on-symbolic-variable-instances">A note on symbolic variable instances</a><a id="A-note-on-symbolic-variable-instances-1"></a><a class="docs-heading-anchor-permalink" href="#A-note-on-symbolic-variable-instances" title="Permalink"></a></h2><p>Recall that when we wrote</p><pre><code class="language-julia hljs">using ConceptualClimateModels.GlobalMeanEBM</code></pre><p>at the start of this tutorial, we brought into scope variables that this (sub)module defines and exports, such as <code>T, α, OLR</code>. They are listed on the (sub)module&#39;s documentation page, and are used in that module&#39;s default processes.</p><p>In some predefined processes documentation you will notice call signatures like</p><pre><code class="language-julia hljs">BasicRadiationBalance(; T, f, kwargs...)</code></pre><p>There are keywords that do not have an assignment like <code>T, f</code> above. This means that use the (sub)module&#39;s predefined variables.</p><p>Crucially, these default variables are <em>symbolic variables</em>. They are defined as</p><pre><code class="language-julia hljs">@variables begin
    T(t) = 0.5 # ...
    # ...
end</code></pre><p>which means that expressions that involve them result in symbolic expressions, for example</p><pre><code class="language-julia hljs">A2 = 0.5
B2 = 0.5
OLR2 = A2 + B2*T</code></pre><p class="math-container">\[ \begin{equation}
0.5 + 0.5 T\left( t \right)
\end{equation}
 \]</p><p>In contrast, if we did instead</p><pre><code class="language-julia hljs">T2 = 0.5 # _not_ symbolic!
OLR3 = A2 + B2*T2</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.75</code></pre><p>This <code>OLR3</code> is <em>not</em> a symbolic expression and <em>cannot</em> be used to represent a process.</p><p>You can use your own variables in any predefined processes. You can define them by doing</p><pre><code class="language-julia hljs">@variables begin
    (T1_tropics(t) = 290.0), [bounds = (200.0, 350.0), description = &quot;temperature in tropical box 1, in Kelvin&quot;]
end</code></pre><p class="math-container">\[ \begin{equation}
\left[
\begin{array}{c}
\mathtt{T1\_tropics}\left( t \right) \\
\end{array}
\right]
\end{equation}
 \]</p><p>and then assign them to the corresponding keyword argument</p><pre><code class="language-julia hljs">process = BasicRadiationBalance(T = T1_tropics)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ConceptualClimateModels.GlobalMeanEBM.BasicRadiationBalance(5.0e8, f(t), T1_tropics(t), ASR(t), OLR(t))</code></pre><p>Defining variables with the extra <code>bounds, description</code> annotations is useful for integrating with the rest of the functionality of the library, and therefore it is strongly recommended.</p><div class="admonition is-category-warn" id="Custom-variables-need-to-be-assigned-everywhere!-2e65476e37d91057"><header class="admonition-header">Custom variables need to be assigned everywhere!<a class="admonition-anchor" href="#Custom-variables-need-to-be-assigned-everywhere!-2e65476e37d91057" title="Permalink"></a></header><div class="admonition-body"><p>Above we assigned <code>T1_tropics</code> as the temperature variable. This means we also need to assign the same variable as the one setting the <code>OLR</code> variable by also providing the processes <code>LinearOLR(T = T1_tropics)</code> (for example).</p></div></div><h2 id="Default-values,-limits,-etc."><a class="docs-heading-anchor" href="#Default-values,-limits,-etc.">Default values, limits, etc.</a><a id="Default-values,-limits,-etc.-1"></a><a class="docs-heading-anchor-permalink" href="#Default-values,-limits,-etc." title="Permalink"></a></h2><p>All predefined variables that could be dynamic variables (i.e., could have a time derivative applied to them) have a default value, a description, and plausible physical bounds.</p><p>To obtain the default value, use <code>default_value(x)</code>. For the description, use <code>getdescription(x)</code>. For the bounds, see <a href="#ConceptualClimateModels.plausible_limits"><code>plausible_limits</code></a>.</p><h2 id="Automatically-named-parameters"><a class="docs-heading-anchor" href="#Automatically-named-parameters">Automatically named parameters</a><a id="Automatically-named-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Automatically-named-parameters" title="Permalink"></a></h2><p>The majority of predefined processes create symbolic parameters that are automatically named based on the variables governing the processes. This default behaviour can be altered in two ways.</p><p>For example, <a href="@ref"><code>IceAlbedoFeedback</code></a> adds named parameters to the equations whose name is derived from the name of the variable representing ice albedo:</p><pre><code class="language-julia hljs">@variables my_ice_α(t) = 0.1 # don&#39;t forget the `(t)`!
ice_process = IceAlbedoFeedback(; α_ice = my_ice_α)
processes = [ice_process]

mtk = processes_to_mtkmodel(processes)
equations(mtk)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{my\_ice\_\alpha}\left( t \right) &amp;= \mathtt{max\_my\_ice\_\alpha} + 0.5 \left(  - \mathtt{max\_my\_ice\_\alpha} + \mathtt{min\_my\_ice\_\alpha} \right) \left( 1 + \tanh\left( \frac{2 \left(  - \mathtt{Tfreeze\_my\_ice\_\alpha} + \frac{1}{2} \mathtt{Tscale\_my\_ice\_\alpha} + T\left( t \right) \right)}{\mathtt{Tscale\_my\_ice\_\alpha}} \right) \right) \\
T\left( t \right) &amp;= \mathtt{T\_0}
\end{align}
 \]</p><pre><code class="language-julia hljs">parameters(mtk)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5-element Vector{SymbolicUtils.BasicSymbolic{Real}}:
 max_my_ice_α
 Tfreeze_my_ice_α
 Tscale_my_ice_α
 min_my_ice_α
 T_0</code></pre><p>We can alter this behaviour by either providing our own named parameters to one of the keywords of the process, or wrapping a value around <code>LiteralParameter</code> to replace the parameter by a literal constant, like so:</p><pre><code class="language-julia hljs">@parameters myfreeze = 260.0
ice_process = IceAlbedoFeedback(;
    α_ice = my_ice_α,
    Tfreeze = myfreeze, # my custom parameter
    max = LiteralParameter(0.9) # don&#39;t make a parameter
)

mtk = processes_to_mtkmodel([ice_process])
equations(mtk)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{my\_ice\_\alpha}\left( t \right) &amp;= 0.9 + 0.5 \left( -0.9 + \mathtt{min\_my\_ice\_\alpha} \right) \left( 1 + \tanh\left( \frac{2 \left( \frac{1}{2} \mathtt{Tscale\_my\_ice\_\alpha} - \mathtt{myfreeze} + T\left( t \right) \right)}{\mathtt{Tscale\_my\_ice\_\alpha}} \right) \right) \\
T\left( t \right) &amp;= \mathtt{T\_0}
\end{align}
 \]</p><pre><code class="language-julia hljs">parameters(mtk)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4-element Vector{SymbolicUtils.BasicSymbolic{Real}}:
 myfreeze
 Tscale_my_ice_α
 min_my_ice_α
 T_0</code></pre><h2 id="Integration-with-DynamicalSystems.jl"><a class="docs-heading-anchor" href="#Integration-with-DynamicalSystems.jl">Integration with DynamicalSystems.jl</a><a id="Integration-with-DynamicalSystems.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Integration-with-DynamicalSystems.jl" title="Permalink"></a></h2><p>ConceptualClimateModels.jl integrates with <a href="https://juliadynamics.github.io/DynamicalSystemsDocs.jl/dynamicalsystems/dev/">DynamicalSystems.jl</a>. It provides some convenience functions that require ModelingToolkit.jl, such as <a href="#ConceptualClimateModels.dynamical_system_summary"><code>dynamical_system_summary</code></a>, <a href="#ConceptualClimateModels.plausible_limits"><code>plausible_limits</code></a> or <a href="#ConceptualClimateModels.named_current_parameters"><code>named_current_parameters</code></a>, see below. Moreover, since all dynamical systems generated by ConceptualClimateModels.jl have symbolic bindings, one can use the symbolic variables in e.g., <a href="https://juliadynamics.github.io/DynamicalSystemsDocs.jl/dynamicalsystems/dev/visualizations/#Interactive-or-animated-trajectory-evolution">interactive GUI exploration</a> or to access or set the parameters of the system.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ConceptualClimateModels.plausible_limits" href="#ConceptualClimateModels.plausible_limits"><code>ConceptualClimateModels.plausible_limits</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plausible_limits(x::Num)</code></pre><p>Return a tuple (min, max) of plausible limiting values for the variable <code>x</code>. If <code>x</code> is defined with the <code>bounds</code> metadata, this is returned as the limits. Else, if <code>x</code> has a default value, the limits are this value ± 20%. Else, if there is no default value, an error is thrown.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ConceptualClimateModels.jl/blob/5f2e05c5735bea5fdcb64ff24ad1cce613a0c3aa/src/statespace.jl#L2-L9">source</a></section><section><div><pre><code class="language-julia hljs">plausible_limits(ds::DynamicalSystem [, idxs])</code></pre><p>Return a vector of limits (min, max) for each dynamic state variable in <code>ds</code>. Optionally provide the <code>idxs</code> of the variables to use as a vector of <code>Symbol</code>s for symbolic variables present in the referrenced MTK model of <code>ds</code>.</p><p>See also <a href="#ConceptualClimateModels.plausible_grid"><code>plausible_grid</code></a>, <a href="#ConceptualClimateModels.plausible_ic_sampler"><code>plausible_ic_sampler</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ConceptualClimateModels.jl/blob/5f2e05c5735bea5fdcb64ff24ad1cce613a0c3aa/src/statespace.jl#L23-L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ConceptualClimateModels.plausible_ic_sampler" href="#ConceptualClimateModels.plausible_ic_sampler"><code>ConceptualClimateModels.plausible_ic_sampler</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plausible_ic_sampler(ds::DynamicalSystem [, seed])</code></pre><p>Return a <code>sampler</code> that can be called as a 0-argument function <code>sampler()</code>, which yields random initial conditions within the hyperrectangle defined by the <a href="#ConceptualClimateModels.plausible_limits"><code>plausible_limits</code></a> of <code>ds</code>. The <code>sampler</code> is useful to give to e.g., <code>DynamicalSystems.basins_fractions</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ConceptualClimateModels.jl/blob/5f2e05c5735bea5fdcb64ff24ad1cce613a0c3aa/src/statespace.jl#L44-L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ConceptualClimateModels.plausible_grid" href="#ConceptualClimateModels.plausible_grid"><code>ConceptualClimateModels.plausible_grid</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plausible_grid(ds::DynamicalSystem, n = 101)</code></pre><p>Return a <code>grid</code> that is a tuple of <code>range</code> objects that each spans the <a href="#ConceptualClimateModels.plausible_limits"><code>plausible_limits</code></a>(<code>ds</code>). <code>n</code> can be an integer or a vector of integers (for each dimension). The resulting <code>grid</code> is useful to give to <code>DynamicalSystems.AttractorsViaRecurrences</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ConceptualClimateModels.jl/blob/5f2e05c5735bea5fdcb64ff24ad1cce613a0c3aa/src/statespace.jl#L58-L65">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ConceptualClimateModels.dynamical_system_summary" href="#ConceptualClimateModels.dynamical_system_summary"><code>ConceptualClimateModels.dynamical_system_summary</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dynamical_system_summary(ds::DynamicalSystem)</code></pre><p>Return a printable/writable string containing a summary of <code>ds</code>, which outlines its current status and lists all symbolic equations and parameters that constitute the system, if a referrence to a ModelingToolkit.jl model exists in <code>ds</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ConceptualClimateModels.jl/blob/5f2e05c5735bea5fdcb64ff24ad1cce613a0c3aa/src/dynamicalsystems.jl#L56-L63">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ConceptualClimateModels.named_current_parameters" href="#ConceptualClimateModels.named_current_parameters"><code>ConceptualClimateModels.named_current_parameters</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">named_current_parameters(ds::DynamicalSystem)</code></pre><p>Return a dictionary mapping parameters of <code>ds</code> (as <code>Symbol</code>s) to their values.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ConceptualClimateModels.jl/blob/5f2e05c5735bea5fdcb64ff24ad1cce613a0c3aa/src/dynamicalsystems.jl#L88-L92">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ConceptualClimateModels.try_set_parameter!" href="#ConceptualClimateModels.try_set_parameter!"><code>ConceptualClimateModels.try_set_parameter!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">try_set_parameter!(ds::DynamicalSystem, symbol, value)</code></pre><p>An extension of <code>set_parameter!</code> for as symbolic parameter, that first checks if the symbol exists in the referenced MTK model, and if not, it warns and returns <code>nothing</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ConceptualClimateModels.jl/blob/5f2e05c5735bea5fdcb64ff24ad1cce613a0c3aa/src/dynamicalsystems.jl#L104-L110">source</a></section></article><h2 id="API-Reference"><a class="docs-heading-anchor" href="#API-Reference">API Reference</a><a id="API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-Reference" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ConceptualClimateModels.processes_to_coupledodes" href="#ConceptualClimateModels.processes_to_coupledodes"><code>ConceptualClimateModels.processes_to_coupledodes</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">processes_to_coupledodes(processes [, default]; kw...)</code></pre><p>Convert a given <code>Vector</code> of processes to a <code>DynamicalSystem</code>, in particular <code>CoupledODEs</code>. All processes represent symbolic equations managed by ModelingToolkit.jl. <code>default</code> is a vector for default processes that &quot;process-less&quot; variables introduced in <code>processes</code> will obtain. Use <a href="#ProcessBasedModelling.processes_to_mtkmodel"><code>processes_to_mtkmodel</code></a> to obtain the MTK model before it is structurally simplified and converted to a <code>DynamicalSystem</code>. See also <a href="#ProcessBasedModelling.processes_to_mtkmodel"><code>processes_to_mtkmodel</code></a> for more details on what <code>processes</code> is, or see the online <a href="@ref">Tutorial</a>.</p><p><strong>Keyword arguments</strong></p><ul><li><code>diffeq</code>: options passed to DifferentialEquations.jl ODE solving when constructing the <code>CoupledODEs</code>.</li><li><code>inplace</code>: whether the dynamical system will be in place or not. Defaults to <code>true</code> if the system dimension is ≤ 5.</li><li><code>split = false</code>: whether to split parameters as per ModelingToolkit.jl. Note the default is not ModelingToolkit&#39;s default, i.e., no splitting occurs. This accelerates parameter access, assuming all parameters are of the same type.</li><li><code>kw...</code>: all other keywords are propagated to <code>processes_to_mtkmodel</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ConceptualClimateModels.jl/blob/5f2e05c5735bea5fdcb64ff24ad1cce613a0c3aa/src/dynamicalsystems.jl#L12-L34">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ProcessBasedModelling.processes_to_mtkmodel" href="#ProcessBasedModelling.processes_to_mtkmodel"><code>ProcessBasedModelling.processes_to_mtkmodel</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">processes_to_mtkmodel(processes::Vector [, default]; kw...)</code></pre><p>Construct a ModelingToolkit.jl model/system using the provided <code>processes</code> and <code>default</code> processes. The model/system is <em>not</em> structurally simplified. Use the function <a href="@ref"><code>processes_to_mtkeqs</code></a> to obtain the raw <code>Vector{Equation}</code> before it is passed to the MTK model/system like <code>ODESystem</code>.</p><p>During construction, the following automations improve user experience:</p><ul><li>Variable(s) introduced in <code>processes</code> that does not themselves have a process obtain a default process from <code>default</code>.</li><li>If no default exists, but the variable(s) have a default numerical value, a <a href="#ProcessBasedModelling.ParameterProcess"><code>ParameterProcess</code></a> is created for said variable(s) and a warning is thrown.</li><li>Else, an informative error is thrown.</li><li>An error is also thrown if any variable has two or more processes assigned to it.</li><li>An error is thrown if any of the given processes are not actually processes, but rather expressions without a LHF-variable.</li></ul><p><code>processes</code> is a <code>Vector</code> whose elements can be:</p><ol><li>Any instance of a subtype of <a href="#ProcessBasedModelling.Process"><code>Process</code></a>. <code>Process</code> is like a wrapper around <code>Equation</code> that provides some conveniences, e.g., handling of timescales or not having limitations on the left-hand-side (LHS) form.</li><li>An <code>Equation</code>. The LHS format of the equation is limited. Let <code>x</code> be a <code>@variable</code> and <code>p</code> be a <code>@parameter</code>. Then, the LHS can only be one of: <code>x</code>, <code>Differential(t)(x)</code>, <code>Differential(t)(x)*p</code>, or <code>p*Differential(t)(x)</code>. The versions with <code>p</code> may fail unexpectedly. Anything else will error.</li><li>A <code>Vector</code> of the above two, which is then expanded. This allows the convenience of functions representing a physical process that may require many equations to be defined (because e.g., they may introduce more variables).</li><li>A ModelingToolkit.jl <code>XDESystem</code>, in which case the <code>equations</code> of the system are expanded as if they were given as a vector of equations like above. This allows the convenience of straightforwardly coupling with already existing <code>XDESystem</code>s.</li></ol><p><strong>Default processes</strong></p><p><code>processes_to_mtkmodel</code> allows for specifying default processes by giving <code>default</code>. These default processes are assigned to variables introduced in the main input <code>processes</code>, but themselves do not have an assigned process in the main input.</p><p><code>default</code> can be a <code>Vector</code> of individual processes (<code>Equation</code> or <code>Process</code>). Alternatively, <code>default</code> can be a <code>Module</code>. The recommended way to build field-specific modelling libraries based on ProcessBasedModelling.jl is to define modules/submodules that offer a pool of pre-defined variables and processes. Modules may register their own default processes via the function <a href="#ProcessBasedModelling.register_default_process!"><code>register_default_process!</code></a>. These registered default processes are used when <code>default</code> is a <code>Module</code>.</p><p><strong>Keyword arguments</strong></p><ul><li><code>type = ODESystem</code>: the model type to make.</li><li><code>name = nameof(type)</code>: the name of the model.</li><li><code>independent = t</code>: the independent variable (default: <code>@variables t</code>). <code>t</code> is also exported by ProcessBasedModelling.jl for convenience.</li><li><code>warn_default::Bool = true</code>: if <code>true</code>, throw a warning when a variable does not have an assigned process but it has a default value so that it becomes a parameter instead.</li><li><code>check_rhs::Bool = true</code>: if <code>true</code>, check that the RHS of all processes is NOT an <code>Equation</code> type. Throw an informative error if there is one. This helps scenarios where the RHS is wrongly an <code>Equation</code> assigning the LHS itself (has happened to me many times!).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ProcessBasedModelling.jl/blob/v1.7.0/src/make.jl#L1-L62">source</a></section></article><h3 id="new_processes"><a class="docs-heading-anchor" href="#new_processes">Making new processes</a><a id="new_processes-1"></a><a class="docs-heading-anchor-permalink" href="#new_processes" title="Permalink"></a></h3><p>To make a new processes you can:</p><ol><li>Create a <em>function</em> that given some keyword arguments uses one of the existing <a href="#generic_processes">generic processes</a> to make and return a process instance. Or, it can return an equation directly, provided it satisfies the format of <a href="#ProcessBasedModelling.processes_to_mtkmodel"><code>processes_to_mtkmodel</code></a>. For an example of this, see the source code of <a href="@ref"><code>SeparatedClearAllSkyAlbedo</code></a> or <a href="@ref"><code>EmissivityFeedbackTanh</code></a>.</li><li>Create a new <code>Process</code> subtype. This is preferred, because it leads to much better printing/display of the list of processes. For an example of this, see the source code of <a href="@ref"><code>IceAlbedoFeedback</code></a>. To create a new <code>Process</code> see the <a href="https://juliadynamics.github.io/ProcessBasedModelling.jl/stable/#Process-API">API of ProcessBasedModelling.jl</a> or read the documentation string of <a href="#ProcessBasedModelling.Process"><code>Process</code></a> below.</li></ol><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ProcessBasedModelling.Process" href="#ProcessBasedModelling.Process"><code>ProcessBasedModelling.Process</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Process</code></pre><p>A new process must subtype <code>Process</code> and can be used in <a href="#ProcessBasedModelling.processes_to_mtkmodel"><code>processes_to_mtkmodel</code></a>. The type must extend the following functions from the module <code>ProcessBasedModelling</code>:</p><ul><li><code>lhs_variable(p)</code> which returns the variable the process describes (left-hand-side variable). There is a default implementation <code>lhs_variable(p) = p.variable</code> if the field exists.</li><li><code>rhs(p)</code> which is the right-hand-side expression, i.e., the &quot;actual&quot; process.</li><li>(optional) <code>timescale(p)</code>, which defaults to <a href="@ref"><code>NoTimeDerivative</code></a>.</li><li>(optional) <code>lhs(p)</code> which returns the left-hand-side. Let <code>τ = timescale(p)</code>. Then default <code>lhs(p)</code> behaviour depends on <code>τ</code> as follows:<ul><li>Just <code>lhs_variable(p)</code> if <code>τ == NoTimeDerivative()</code>.</li><li><code>Differential(t)(p)</code> if <code>τ == nothing</code>, or multiplied with a number if <code>τ isa LiteralParameter</code>.</li><li><code>τ_var*Differential(t)(p)</code> if <code>τ isa Union{Real, Num}</code>. If real, a new named parameter <code>τ_var</code> is created that has the prefix <code>:τ_</code> and then the lhs-variable name and has default value <code>τ</code>. Else if <code>Num</code>, <code>τ_var = τ</code> as given.</li><li>Explicitly extend <code>lhs_variable</code> if the above do not suit you.</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ProcessBasedModelling.jl/blob/v1.7.0/src/API.jl#L1-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ProcessBasedModelling.register_default_process!" href="#ProcessBasedModelling.register_default_process!"><code>ProcessBasedModelling.register_default_process!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">register_default_process!(process, m::Module; warn = true)</code></pre><p>Register a <code>process</code> (<code>Equation</code> or <code>Process</code>) as a default process for its LHS variable in the list of default processes tracked by the given module. If <code>warn</code>, throw a warning if a default process with same LHS variable already exists and will be overwritten.</p><p>You can use <a href="@ref"><code>default_processes</code></a> to obtain the list of tracked default processes.</p><div class="admonition is-info" id="For-developers-787c44c6d00e5306"><header class="admonition-header">For developers<a class="admonition-anchor" href="#For-developers-787c44c6d00e5306" title="Permalink"></a></header><div class="admonition-body"><p>If you are developing a new module/package that is based on ProcessBasedModelling.jl, and within it you also register default processes, then enclose your <code>register_default_process!</code> calls within the module&#39;s <code>__init__()</code> function. For example:</p><pre><code class="language-julia hljs">module MyProcesses
# ...

function __init__()
    register_default_process!.(
        [
            process1,
            process2,
            # ...
        ],
        Ref(MyProcesses)
    )
end

end # module</code></pre></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ProcessBasedModelling.jl/blob/v1.7.0/src/default.jl#L5-L37">source</a></section></article><h2 id="generic_processes"><a class="docs-heading-anchor" href="#generic_processes">Generic processes</a><a id="generic_processes-1"></a><a class="docs-heading-anchor-permalink" href="#generic_processes" title="Permalink"></a></h2><p>Processes that do not depend on any particular physical concept and instead provide a simple way to create new processes for a given climate variable:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ProcessBasedModelling.ParameterProcess" href="#ProcessBasedModelling.ParameterProcess"><code>ProcessBasedModelling.ParameterProcess</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ParameterProcess(variable, value = default_value(variable)) &lt;: Process</code></pre><p>The simplest process which equates a given <code>variable</code> to a constant value that is encapsulated in a parameter. If <code>value isa Real</code>, then a named parameter with the name of <code>variable</code> and <code>_0</code> appended is created. Else, if <code>valua isa Num</code> then it is taken as the paremeter directly.</p><p>Example:</p><pre><code class="language-julia hljs">@variables T(t) = 0.5
proc = ParameterProcess(T)</code></pre><p>will create the equation <code>T ~ T_0</code>, where <code>T_0</code> is a <code>@parameter</code> with default value <code>0.5</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ProcessBasedModelling.jl/blob/v1.7.0/src/processes_basic.jl#L1-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ProcessBasedModelling.TimeDerivative" href="#ProcessBasedModelling.TimeDerivative"><code>ProcessBasedModelling.TimeDerivative</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TimeDerivative(variable, expression [, τ])</code></pre><p>The second simplest process that equates the time derivative of the <code>variable</code> to the given <code>expression</code> while providing some conveniences over manually constructing an <code>Equation</code>.</p><p>It creates the equation <code>τ_$(variable) Differential(t)(variable) ~ expression</code> by constructing a new <code>@parameter</code> with default value <code>τ</code> (if <code>τ</code> is already a <code>@parameter</code>, it is used as-is). If <code>τ</code> is not given, then 1 is used at its place and no parameter is created.</p><p>Note that if <code>iszero(τ)</code>, then the process <code>variable ~ expression</code> is created.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ProcessBasedModelling.jl/blob/v1.7.0/src/processes_basic.jl#L28-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ProcessBasedModelling.ExpRelaxation" href="#ProcessBasedModelling.ExpRelaxation"><code>ProcessBasedModelling.ExpRelaxation</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ExpRelaxation(variable, expression [, τ]) &lt;: Process</code></pre><p>A common process for creating an exponential relaxation of <code>variable</code> towards the given <code>expression</code>, with timescale <code>τ</code>. It creates the equation:</p><pre><code class="nohighlight hljs">τn*Differential(t)(variable) ~ expression - variable</code></pre><p>Where <code>τn</code> is a new named <code>@parameter</code> with the value of <code>τ</code> and name <code>τ_($(variable))</code>. If instead <code>τ</code> is <code>nothing</code>, then 1 is used in its place (this is the default behavior). If <code>iszero(τ)</code>, then the equation <code>variable ~ expression</code> is created instead.</p><p>The convenience function</p><pre><code class="language-julia hljs">ExpRelaxation(process, τ)</code></pre><p>allows converting an existing process (or equation) into an exponential relaxation by using the <code>rhs(process)</code> as the <code>expression</code> in the equation above.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ProcessBasedModelling.jl/blob/v1.7.0/src/processes_basic.jl#L59-L78">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ProcessBasedModelling.AdditionProcess" href="#ProcessBasedModelling.AdditionProcess"><code>ProcessBasedModelling.AdditionProcess</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AdditionProcess(process, added...)</code></pre><p>A convenience process for adding processes <code>added</code> to the <code>rhs</code> of the given <code>process</code>. <code>added</code> can be a single symbolic expression. Otherwise, <code>added</code> can be a <code>Process</code> or <code>Equation</code>, or multitude of them, in which case it is checked that the <code>lhs_variable</code> across all added components matches the <code>process</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ProcessBasedModelling.jl/blob/v1.7.0/src/processes_basic.jl#L100-L107">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ConceptualClimateModels.SigmoidProcess" href="#ConceptualClimateModels.SigmoidProcess"><code>ConceptualClimateModels.SigmoidProcess</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SigmoidProcess &lt;: Process
SigmoidProcess(variable, driver; left, right, scale, reference)</code></pre><p>A common process for when a <code>variable</code> has a sigmoidal dependence on a <code>driver</code> variable. The rest of the input arguments should be real numbers or <code>@parameter</code> named parameters.</p><p>The process creates a sigmoidal relationship based on the <code>tanh</code> function:</p><pre><code class="nohighlight hljs">variable ~ left + (right - left)*(1 + tanh(2(driver - reference)/scale))*0.5</code></pre><p>i.e., the variable goes from value <code>left</code> to value <code>right</code> as <code>driver</code> increases over a range of <code>scale</code> (centered at <code>reference</code>). Instead of <code>reference</code> you may provide <code>start</code> or <code>finish</code> keywords, which make <code>reference = start + scale/2</code> or <code>reference = finish - scale/2</code> respectively.</p><p>If the values given to the parameters of the expression are real numbers, they become named parameters prefixed with the name of <code>variable</code>, then the name of the <code>driver</code>, and then <code>_sigmoid_left</code>, <code>_sigmoid_right</code>, <code>_sigmoid_rate</code> and <code>_sigmoid_ref</code> respectively. Use <code>LiteralParameter</code> for parameters you do not wish to rename.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ConceptualClimateModels.jl/blob/5f2e05c5735bea5fdcb64ff24ad1cce613a0c3aa/src/processes_advanced.jl#L5-L25">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Introduction</a><a class="docs-footer-nextpage" href="../submodules/globalmeanebm/">Global mean EBM »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Thursday 28 August 2025 15:44">Thursday 28 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
